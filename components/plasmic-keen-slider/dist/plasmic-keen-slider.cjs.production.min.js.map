{"version":3,"file":"plasmic-keen-slider.cjs.production.min.js","sources":["../src/index.tsx"],"sourcesContent":["import registerComponent, {\n  ActionProps,\n  CodeComponentMeta,\n} from \"@plasmicapp/host/registerComponent\";\nimport { Button, Select } from \"antd\";\nimport React, { forwardRef, Ref, useEffect } from \"react\";\nimport { useKeenSlider, KeenSliderPlugin } from \"keen-slider/react\";\nimport composeRefs from \"@seznam/compose-react-refs\";\nimport { KeenSliderOptions } from \"keen-slider\";\n\nconst { Option } = Select;\n\nconst ResizePlugin: KeenSliderPlugin = (slider) => {\n  const observer = new ResizeObserver(function () {\n    slider.update();\n  });\n\n  slider.on(\"created\", () => {\n    observer.observe(slider.container);\n  });\n  slider.on(\"destroyed\", () => {\n    observer.unobserve(slider.container);\n  });\n};\n\nfunction CurrentSlideDropdown({ componentProps, studioOps }: ActionProps<any>) {\n  const editingSlide = componentProps.editingSlide ?? 0;\n  const slidesCnt =\n    componentProps.children.length ??\n    (componentProps.children.type === \"img\" ? 1 : 0);\n\n  const options = Array.from({ length: slidesCnt }, (_, i) => i).map((i) => {\n    return <Option value={i.toString()}>Slide {i + 1}</Option>;\n  });\n\n  const handleChange = (value: string) => {\n    const slideIdx = Number(value);\n    studioOps.updateProps({ editingSlide: slideIdx % slidesCnt });\n  };\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        display: \"flex\",\n        flexDirection: \"row\",\n        gap: \"10px\",\n        justifyContent: \"space-between\",\n      }}\n    >\n      <div>Current slide:</div>\n      <Select\n        defaultValue={editingSlide.toString()}\n        style={{ width: \"100%\" }}\n        onChange={handleChange}\n        value={editingSlide.toString()}\n      >\n        {options}\n      </Select>\n    </div>\n  );\n}\n\nfunction NavigateSlides({ componentProps, studioOps }: ActionProps<any>) {\n  const slidesCnt = componentProps.children.length;\n  const editingSlide = componentProps.editingSlide ?? 0;\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        display: \"flex\",\n        flexDirection: \"row\",\n        gap: \"10px\",\n        justifyContent: \"space-between\",\n      }}\n    >\n      <Button\n        style={{ width: \"100%\" }}\n        onClick={() => {\n          const prevSlide = (editingSlide - 1 + slidesCnt) % slidesCnt;\n          studioOps.updateProps({ editingSlide: prevSlide });\n        }}\n      >\n        Prev slide\n      </Button>\n      <Button\n        style={{ width: \"100%\" }}\n        onClick={() => {\n          const nextSlide = (editingSlide + 1) % slidesCnt;\n          studioOps.updateProps({ editingSlide: nextSlide });\n        }}\n      >\n        Next slide\n      </Button>\n    </div>\n  );\n}\n\nfunction OutlineMessage() {\n  return <div>* To re-arrange slides, use the Outline panel</div>;\n}\n\ninterface KeenSliderProps extends KeenSliderOptions {}\n\nexport const sliderMeta: CodeComponentMeta<KeenSliderProps> = {\n  name: \"hostless-slider-custom\",\n  displayName: \"Slider\",\n  importName: \"Slider\",\n  importPath: \"keen-slider\",\n  actions: [\n    {\n      type: \"custom-action\",\n      control: CurrentSlideDropdown,\n    },\n    {\n      type: \"custom-action\",\n      control: NavigateSlides,\n    },\n    {\n      type: \"button-action\",\n      label: \"Append new slide\",\n      onClick: ({ componentProps, studioOps }: ActionProps<any>) => {\n        const slidesCnt = componentProps.children.length;\n        studioOps.appendToSlot(\n          {\n            type: \"img\",\n            src: \"\",\n          },\n          \"children\"\n        );\n        studioOps.updateProps({ editingSlide: slidesCnt });\n      },\n    },\n    {\n      type: \"button-action\",\n      label: \"Delete current slide\",\n      onClick: ({\n        componentProps,\n        contextData,\n        studioOps,\n      }: ActionProps<any>) => {\n        const editingSlide = contextData.editingSlide ?? 0;\n        studioOps.removeFromSlotAt(editingSlide, \"children\");\n        const slidesCnt = componentProps.children.length - 1;\n        studioOps.updateProps({\n          editingSlide: (editingSlide - 1 + slidesCnt) % slidesCnt,\n        });\n      },\n    },\n    {\n      type: \"custom-action\",\n      control: OutlineMessage,\n    },\n  ],\n  props: {\n    children: {\n      type: \"slot\",\n      defaultValue: [0, 1, 2].map((i) => ({\n        type: \"vbox\",\n        children: {\n          type: \"img\",\n          src:\n            \"https://static1.plasmic.app/components/react-slick/slide\" +\n            (i + 1) +\n            \".png\",\n          styles: {\n            maxWidth: \"100%\",\n          },\n        },\n      })),\n    },\n    editingSlide: {\n      displayName: \"Currently edited slide\",\n      type: \"number\",\n      description:\n        \"Switch to the specified slide (first is 0). Only affects the editor, not the final page.\",\n      defaultValueHint: 0,\n      editOnly: true,\n      hidden: () => true,\n    },\n    disabled: {\n      displayName: \"Disabled\",\n      type: \"boolean\",\n      description: \"Disable or enable slider\",\n      defaultValueHint: false,\n    },\n    drag: {\n      displayName: \"Drag\",\n      type: \"boolean\",\n      description: \"Enables or disables mouse and touch control\",\n      defaultValueHint: true,\n    },\n    dragSpeed: {\n      displayName: \"Drag Speed\",\n      type: \"number\",\n      description:\n        \"Set the speed that is applied to the slider when dragging it.\",\n      defaultValueHint: 1,\n    },\n    initial: {\n      displayName: \"Initial slide\",\n      type: \"number\",\n      description: \"Sets the index of initially visible slide\",\n      defaultValueHint: 1,\n    },\n    loop: {\n      displayName: \"Loop\",\n      type: \"boolean\",\n      description:\n        \"Enable or disables carousel/loop functionality of the slider\",\n      defaultValueHint: false,\n    },\n\n    mode: {\n      displayName: \"Carousel mode\",\n      type: \"choice\",\n      options: [\"snap\", \"free\", \"free-snap\"],\n      description: \"Sets the animation that is applied after a drag ends\",\n      defaultValueHint: \"snap\",\n    },\n    renderMode: {\n      displayName: \"Render mode\",\n      type: \"choice\",\n      options: [\"precision\", \"performance\", \"custom\"],\n      description:\n        \"It is possible that the render performance of the browser slows down, if you have slides with some complexity in markup and CSS. To counteract this problem, you can set this option to 'performance'. If you want to create your own renderer, you can set this options to 'custom'. Default is 'precision'.\",\n      defaultValueHint: \"precision\",\n    },\n    rtl: {\n      displayName: \"Reverse\",\n      type: \"boolean\",\n      description: \"Reverses the slide order\",\n      defaultValueHint: false,\n    },\n\n    rubberband: {\n      displayName: \"Rubberband \",\n      type: \"boolean\",\n      description:\n        \"Enables or disables rubberband behavior for dragging and animation after a drag.\",\n      defaultValueHint: true,\n    },\n    slides: {\n      displayName: \"Number of slides\",\n      type: \"number\",\n      description: \"Specifies number of slider \",\n    },\n\n    vertical: {\n      displayName: \"Vertical\",\n      type: \"boolean\",\n      description: \"Vertical slide mode\",\n      defaultValueHint: false,\n      helpText:\n        \"(Note: The height of the container must be defined if vertical is true)\",\n    },\n  },\n\n  defaultStyles: {\n    width: \"stretch\",\n    maxWidth: \"100%\",\n    flexDirection: \"column\",\n  },\n};\n\nexport const SliderWrapper = forwardRef(function SliderWrapper_(\n  {\n    editingSlide,\n    children,\n\n    className,\n    setControlContextData,\n    ...props\n  }: KeenSliderProps & {\n    className?: string;\n    editingSlide?: number;\n    children?: any;\n    setControlContextData?: (data: {\n      editingSlide: number | undefined;\n    }) => void;\n  },\n  userRef?: Ref<HTMLDivElement>\n) {\n  setControlContextData?.({ editingSlide: editingSlide });\n  const [sliderRef, instanceRef] = useKeenSlider<HTMLDivElement>(\n    {\n      ...props,\n    },\n    [ResizePlugin]\n  );\n\n  useEffect(() => {\n    if (editingSlide !== undefined) {\n      instanceRef.current!.moveToIdx(editingSlide);\n    }\n  }, [editingSlide]);\n\n  return (\n    <div className={className}>\n      <div\n        ref={composeRefs(sliderRef, userRef)}\n        className=\"keen-slider\"\n        {...props}\n        style={{ height: \"100%\" }}\n      >\n        {React.Children.map(children, (child) =>\n          React.cloneElement(child, {\n            className: `keen-slider__slide ${className}`,\n          })\n        )}\n        {children}\n      </div>\n    </div>\n  );\n});\n\nexport function registerSlider(\n  loader?: { registerComponent: typeof registerComponent },\n  customSliderMeta?: CodeComponentMeta<KeenSliderOptions>\n) {\n  if (loader) {\n    loader.registerComponent(SliderWrapper, customSliderMeta ?? sliderMeta);\n  } else {\n    registerComponent(SliderWrapper, customSliderMeta ?? sliderMeta);\n  }\n}\n"],"names":["Option","Select","ResizePlugin","slider","observer","ResizeObserver","update","on","observe","container","unobserve","sliderMeta","name","displayName","importName","importPath","actions","type","control","_ref","componentProps","studioOps","editingSlide","_componentProps$editi","slidesCnt","_componentProps$child","children","length","options","Array","from","_","i","map","React","value","toString","style","width","display","flexDirection","gap","justifyContent","defaultValue","onChange","slideIdx","Number","updateProps","_ref2","_componentProps$editi2","Button","onClick","label","_ref3","appendToSlot","src","_ref4","_contextData$editingS","contextData","removeFromSlotAt","props","styles","maxWidth","description","defaultValueHint","editOnly","hidden","disabled","drag","dragSpeed","initial","loop","mode","renderMode","rtl","rubberband","slides","vertical","helpText","defaultStyles","SliderWrapper","forwardRef","_ref5","userRef","className","setControlContextData","_objectWithoutPropertiesLoose","_excluded","_useKeenSlider","useKeenSlider","_extends","sliderRef","instanceRef","useEffect","undefined","current","moveToIdx","ref","composeRefs","height","Children","child","cloneElement","loader","customSliderMeta","registerComponent"],"mappings":"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"}